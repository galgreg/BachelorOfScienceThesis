\chapter{Samochody autonomiczne}

\section{Opis problemu}
Autonomiczny samochód to pojazd zdolny do interpretacji swojego otoczenia i bezpiecznego poruszania się w nim bez potrzeby ludzkiej ingerencji \cite{synopsys:whatIsAutonomousCar}. Taki pojazd potrafi robić to samo, co doświadczony kierowca robiłby prowadząc swój samochód.

\subsection{Poziomy automatyzacji sterowania}
Organizacja SAE (Society of Automotive Engineers) definiuje skalę, zakładającą sześć poziomów automatyzacji sterowania pojazdów \cite{synopsys:sixLevelsOfCarAutonomy}:
\begin{enumerate*}
\item Poziom 0 - sterowanie w pełni ręczne (\textbf{No Driving Automation}). Dotyczy większości samochodów poruszających się obecnie po drogach.
\item Poziom 1 - wsparcie kierowcy (\textbf{Driver Assistance}). Najniższy poziom automatyzacji. Samochód posiada prosty system wspomagający pojedyncze aspekty sterowania, np. kontrola kierownicy lub kontrola przyspieszenia samochodu (tzw. dynamiczny tempomat). 
Dynamiczny tempomat kwalifikuje się na poziom 1, ponieważ kierowca musi samodzielnie kontrolować pozostałe aspekty sterowania samochodem.
\item Poziom 2 - częściowa automatyzacja sterowania (\textbf{Partial Driving Automation}). Oznacza stosowanie zaawansowanych systemów wspomagania kierowcy (ADAS - Advanced Driver Assistant Systems) \cite{adas:opis}. Samochód potrafi kontrolować zarówno kierownicę jak również prędkość pojazdu. Samochód nie jest jednak w pełni autonomiczny, więc osoba siedząca za kierownicą może w każdej chwili przejąć kontrolę nad samochodem. Przykładem systemu będącego na Poziomie 2 jest Tesla Autopilot.
\item Poziom 3 - warunkowa automatyzacja sterowania (\textbf{Conditional Driving Automation}). Samochody posiadają system detekcji otoczenia, więc mogą podejmować decyzje, takie jak przyspieszanie obok powoli poruszającego się pojazdu. Jednakże wciąż wymagają nadzoru człowieka. Kierowca musi być przygotowany, iż w każdej chwili będzie musiał przejąć kontrolę nad samochodem, jeśli system nie poradzi sobie w danej sytuacji. \\
Obecna generacja samochodu Audi A8 oferuje system Traffic Jam Pilot \cite{audi:trafficJamPilot}, który zapewnia autonomiczność sterowania na Poziomie 3. Jest to pierwszy przypadek, w którym samochód produkowany seryjnie oferuje taki system \cite{audi:newAudiA8ConditionalAutomated}.
\item Poziom 4 - wysoka automatyzacja sterowania (\textbf{High Driving Automation}). Samochód potrafi interweniować jeśli "coś pójdzie nie tak", np. jeśli dojdzie do błędu systemu. W tej sytuacji, samochód nie potrzebuje ludzkiej ingerencji \textit{w większości przypadków}. Jednakże, kierowca wciąż może przejąć kontrolę nad samochodem. Przykłady występowania samochodów o autonomiczności na Poziomie 4:
\begin{itemize*}
\item Samochody elektryczne marki Navya - Autonom Shuttle oraz Autonom Cab \cite{motorAuthority:navyaCars}
\item Firma Waymo udostępniła usługę taksówkarską w Arizonie, gdzie samochody z autonomicznością na Poziomie 4 przewożą klientów  \cite{waymoAutonomousTaxi}.
\end{itemize*}
\item Poziom 5 - pełna automatyzacja sterowania (Full Driving Automation). Zachowanie pojazdu nigdy nie wymaga uwagi człowieka. Samochody Poziomu 5 nie będą nawet posiadać kierownicy ani pedałów. Będą wolne od ograniczeń obszarowych (geofencing), na których mogą się poruszać. W pełni autonomiczne samochody są obecnie testowane w kilku miejscach na świecie, jednakże żaden z tych systemów nie jest dostępny publicznie.
\end{enumerate*}

\begin{figure}[h]
\begin{center}
\includegraphics[width=15cm]{resources/figures/automation_levels.jpg}
\caption{Poziomy automatyzacji sterowania samochodem (według SAE)}
\label{CarAutomationLevels}
\end{center}
\end{figure}

Skala ta została zaakceptowana przez Amerykański Departament Transportu.

\subsection{Zasady działania}
Autonomiczne samochody korzystają z wszelkiego rodzaju urządzeń rejestrujących stan otoczenia, takich jak czujniki, radary i kamery. Radary monitorują pozycję obiektów znajdujących się wokół pojazdu, kamery wideo rozpoznają znaki drogowe oraz tor ruchu innych obiektów. Czujniki LIDAR (Light Detection and Ranging) odbijają impulsy świetlne od otoczenia samochodu. Dzięki temu są w stanie odmierzać dystans, rozpoznawać pobocza dróg oraz identyfikować oznaczenia pasa ruchu.
Czujniki ultradźwiękowe, montowane w kołach, rozpoznają krawężniki oraz inne pojazdy podczas parkowania.

Skomplikowane oprogramowanie przetwarza dane z urządzeń wejściowych, oblicza parametry dalszej jazdy (takie jak kierunek lub prędkość) i wysyła je do siłowników samochodu, które kontrolują przyspieszenie, hamowanie i kąt skrętu kierownicy.

\subsection{Wyzwania stawiane producentom}
W pełni autonomiczne samochody są poddawane wyczerpującym testom w kilku miejscach na świecie, jednakże żaden z nich nie jest dostępny publicznie. Od wprowadzenia takich systemów do produkcji seryjnej dzieli nas jeszcze wiele lat. Ponadto, przed projektantami i producentami stoi szereg wyzwań na polu technologicznym, prawnym, środowiskowym, a nawet filozoficznym. \\
Część z tych wyzwań to:
\begin{enumerate*}
\item LIDAR - problem wzajemnego zakłócania sygnałów w sytuacji gdy wiele autonomicznych samochodów będzie jechało blisko siebie. W sytuacji stosowania wielu różnych częstotliwości, czy zakres częstotliwości będzie wystarczająco szeroki aby obsłużyć masową produkcję takich pojazdów?
\item Warunki pogodowe - co się dzieje, gdy samochody autonomiczne podróżują w bardzo ciężkich warunkach? Jeśli śnieg zalega na drodze, oznaczenia pasa ruchu są niewidoczne. Jak kamery i czujniki będą rozpoznawać pasy ruchu, jeśli oznaczenia są zamazywane przez wodę, lód, olej lub błoto?
\item Regulacje prawne - wiele kwestii wymaga uregulowania, co nie będzie łatwe, bo dotyczy bardzo skomplikowanych zagadnień. Najistotniejszym z nich będzie kwestia \textbf{ustalenia odpowiedzialności prawnej za ewentualne wypadki powodowane przez samochody autonomiczne}.

\newpage
Cytując Norberta Biedrzyckiego z portalu Business Insider \cite{businessInsider:autonomiczneAutaPrawo}: \\
\begin{itshape}
,,Kto w sytuacji kolizji, zagrożenia czy nawet utraty życia, staje się przedmiotem sporu, możliwego pozwu, czy odszkodowania? Kto ma ponosić zasadniczą odpowiedzialność w sytuacji, w której giną osoby w wypadku z udziałem autonomicznych pojazdów? Czy kłopoty będzie miał producent algorytmu, w oparciu o który porusza się autonomiczne auto na drodze, firma produkująca takie auto, czy kierowca – właściciel? A jeśli ten ostatni spowoduje wypadek, czy może on liczyć na wystarczające rozwiązania związane z ubezpieczeniem, które zapewnią mu komfort użytkowania? \\

Na tym przykładzie widać wyraźnie, że możliwości technologiczne wyprzedzają nasze czasy. Tutaj właściwie wszystko jest możliwe – bo całe floty autonomicznych ciężarówek czekają już, by wyruszyć w drogę, a myśl o tym, by budować usługi taksówkarskie w oparciu o autonomiczne pojazdy, zaprząta głowę niejednemu biznesmenowi. \\

Okazuje się jednak, że podstawową barierą, która jeszcze długo będzie blokować zmiany na światowych drogach, będą kwestie niewystarczających uregulowań prawnych.''
\end{itshape}
\end{enumerate*}

\subsection{Korzyści z istnienia samochodów autonomicznych}
Scenariusze w których fakt wykorzystania pojazdów autonomicznych podnosi poziom wygody i jakości życia wydają się nieograniczone. Osoby starsze i niepełnosprawne mogą zyskać niezależność. Można wysłać psa do weterynarza. Albo przywieźć dzieciom na obóz brakujące rzeczy, których zapomniały zapakować.

Oprócz tego, z samochodami autonomicznymi wiąże się ogromną nadzieję, iż przyczynią się do drastycznego obniżenia emisji dwutlenku węgla do atmosfery. W artykule z 2017 roku, opublikowanego przez organizację ITDP, zamieszczono analizę na temat przyszłości transportu drogowego w kontekście wykorzystania samochodów autonomicznych \cite{itdp:urbanTransportRevolutions}. Autorzy analizy zwrócili uwagę na trzy tendencje we współczesnym spojrzeniu na transport, które jeśli będą występować jednocześnie, uwolnią pełny potencjał drzemiący w samochodach autonomicznych:
\begin{itemize*}
\item Automatyzacja
\item Elektryfikacja
\item Współdzielenie środka transportu (ridesharing)
\end{itemize*}
\newpage
Autorzy szacują, iż dzięki tym trzem ,,rewolucjom'', do roku 2050 będzie można osiągnąć:
\begin{enumerate*}
\item Zmniejszenie natężenia ruchu miejskiego o 30\%
\item Oszczędności w kosztach transportu na poziomie 40\%
\item Redukcję dwutlenku węgla emitowanego przez miasta na poziomie 80\% w skali światowej
\end{enumerate*}

\begin{figure}[h]
\begin{center}
\includegraphics[width=15cm]{resources/figures/itdp_infographic.jpg}
\caption{Przyszłość transportu miejskiego wg organizacji ITDP}
\label{IdtpTransportFuture}
\end{center}
\end{figure}

\section{Podejścia stosowane do rozwiązania problemu}
Stworzenie samochodu autonomicznego, który będzie w stanie samodzielnie poruszać się po otoczeniu i służyć jako środek transportu dla milionów ludzi na świecie, nie jest zadaniem trywialnym. Wymaga rozwiązania szeregu problemów, związanych z tym zagadnieniem. Takimi problemami mogą być chociażby rozpoznawanie znaków drogowych czy predykcja zachowań innych uczestników ruchu drogowego. Każdy z tych problemów może zostać rozpatrzony na wiele sposobów, istnieje zatem wiele alternatywnych rozwiązań dla danego problemu. Często nie można stwierdzić, czy dane rozwiązanie jest lepsze od reszty. Po prostu każde takie rozwiązanie ma swoją specyfikę, a co za tym idzie swoje wady i zalety.

Dlatego jest oczywiste, że firmy podejmujące się zbudowania samochodu autonomicznego mogą przyjmować różne, czasem skrajne podejścia w kwestii rozwiązań stosowanych w procesie tworzenia takiej maszyny.

Jednym z najtrudniejszych problemów do rozwiązania jest kwestia orientacji w terenie. Zagadnienie te zostało pokrótce przedstawione w artykule \cite{threeApproachesToOrientation}.
Artykuł prezentuje również trzy propozycje rozwiązania tego problemu. Warto zauważyć, że każda z tych propozycji znacząco różni się od pozostałych.

\section{Typy istniejących rozwiązań}
Tematyka tworzenia samochodów autonomicznych, bądź też samochodów o dużym stopniu automatyzacji sterowania, stała się w ostatnich latach niezwykle popularna. Z tego powodu istnieje obecnie ogromna ilość projektów nawiązujących do tej tematyki.

Projekty te tworzą bardzo interesujące spektrum przypadków. Różnią między sobą w wielu aspektach, takich jak:
\begin{itemize*}
\item stopień skomplikowania projektu
\item podejście do rozwiązywania poszczególnych aspektów projektu
\item zakres tematyczny projektu
\item środowisko testowania
\item i wiele innych
\end{itemize*}

Na podstawie własnych obserwacji, postanowiłem podzielić te projekty na kilka zasadniczych grup:

\begin{enumerate*}
\item \textbf{Wielkie projekty badawczo-rozwojowe} \\
Projekty o największym stopniu skomplikowania. Rozwijane przez zespoły składające się z setek lub tysięcy ludzi. Czasem są to zespoły pracujące w ramach międzynarodowych korporacji posiadających gigantyczne budżety i zaplecze kadrowo-techniczne. Innym razem są to projekty open source, w które zaangażowani są ludzie z różnych zakątków świata. Często zdarza się, iż dany projekt jest rozwijany dzięki współpracy kilku partnerów, działających w różnych sektorach gospodarczych lub badawczych. \\
Projekty należące do powyższej grupy podchodzą do problemu tworzenia samochodu autonomicznego w sposób najbardziej kompleksowy. Ich celem jest najczęściej stworzenie pojazdu poruszającego się w rzeczywistym środowisku, który będzie w stanie poradzić sobie w każdych warunkach bez potrzeby ingerencji człowieka.
Część z tych projektów jest rozwijana z myślą o wdrożeniu do produkcji seryjnej, do zastosowania w prawdziwym transporcie drogowym, do przewozu osób na masową skalę.
Inne projekty mają charakter czysto badawczy. Ich celem jest eksploracja nowych strategii rozwiązywania danego problemu. Część z tych strategii, jeśli wykaże swoją wartość podczas serii testów, może zostać zaadoptowana do systemów produkowanych seryjnie. \\

\item \textbf{Środowiska symulacyjne} \\
Nie są to projekty ściśle związane z tworzeniem samochodu autonomicznego. Są to raczej projekty, którego celem jest ułatwienie prac nad rozwojem takich maszyn innym twórcom. Osiągane jest to poprzez tworzenie wirtualnych środowisk symulacyjnych, dostosowanych do tego typu potrzeb.

Praca w symulatorze posiada wiele zalet względem operowania na rzeczywistych maszynach. Najważniejszą z nich jest duża oszczędność pieniędzy i czasu. Symulatory pozwalają na szybkie i bezpieczne testowanie wymyślanych rozwiązań.

Faktem jest, iż wszystkie firmy pracujące nad wielkimi projektami badawczo-rozwojowymi, w mniejszym lub większym stopniu korzystają z takich środowisk symulacyjnych. \\

\item \textbf{Projekty modelarskie} \\
To projekty, które nie są realizowane ani na rzeczywistych samochodach, ani w środowiskach symulacyjnych. Są to projekty, w których eksperymenty przeprowadzane są na miniaturowych modelach samochodów. Czasami te modele nie są odwzorowaniem żadnego rzeczywistego samochodu. Mogą to być projekty wysokobudżetowe, rozwijane w celach komercyjnych. \\

\item \textbf{Małe prywatne projekty} \\
Są to niewielkie projekty, realizowane przez pojedyncze osoby lub małe zespoły złożone z kilku osób. Często podchodzą do problemu w sposób mniej kompleksowy, skupiając się na eksploracji tylko wybranych aspektów problemu. Są to projekty niskobudżetowe, realizowane hobbistycznie, najczęściej w celach edukacyjnych. Rzadko się zdarza, że takie projekty są komercjalizowane. Często są jednak udostępniane publicznie. \\
Najczęściej takie projekty są realizowane w środowiskach symulacyjnych (czasem własnoręcznie tworzonych), rzadziej są to projekty modelarskie. Zdecydowanie najrzadszą, praktycznie niewystępującą grupą są projekty realizowane na rzeczywistych samochodach. Wiąże się to oczywiście z kosztami, jakie należałoby ponieść w takim wypadku.

\end{enumerate*}

Chciałbym w tym miejscu zaznaczyć, że powyższy podział nie może być w żadnym razie traktowany jako formalny. 
Użyte przeze mnie sformułowania mogą nie być precyzyjne, co może prowadzić do nieporozumień i mylnych interpretacji.
Ponadto, klasyfikacja którą przedstawiłem może nie być kompletna. Być może istnieją projekty, których nie można zaklasyfikować do żadnej z powyższych grup. Temat wymaga dalszych badań, co niestety wykracza poza zakres tej pracy. \\
W dalszej części rozdziału zostaną zaprezentowane przykłady dla każdej z opisanych grup. 

\section{Wielkie projekty badawcze}
W obecnych czasach, wiele korporacji o zasięgu międzynarodowym angażuje się w prace nad rozwojem samochodów autonomicznych. 
Niniejsze zestawienie zawiera tylko bardzo mały wycinek z listy istniejących rozwiązań.

\subsection{Waymo}
Przedsiębiorstwo technologiczne, które od grudnia 2016 roku należy do holdingu Alphabet Inc. Wcześniej istniało jako jeden z projektów firmy Google. Waymo zajmuje się rozwojem samochodów autonomicznych. Początki sięgają roku 2009, kiedy to firma Google rozpoczęła prace nad pierwszym prototypem w sekretnym laboratorium. Więcej na temat historii projektu można dowiedzieć się w artykule \cite{google:carHistory}.

System na obecnym etapie rozwoju jest uznawany za jeden z najbardziej dojrzałych i przetestowanych systemów istniejących na świecie. Ma za sobą przejechanych kilka milionów mil w rzeczywistym świecie i wiele miliardów mil odbytych w środowiskach symulacji. System był testowany w wielu lokalizacjach znajdujących się na terenie USA. Poprzez jazdy odbywane w bardzo zróżnicowanych warunkach pogodowych, auta były przystosowywane do radzenia sobie w bardzo szerokim spektrum możliwych scenariuszy drogowych.

Dla każdego obszaru, po którym ma się poruszać samochód Waymo, zespół musi wcześniej przygotować szczegółowe mapy 3D z uwzględnieniem takich informacji, jak profile dróg \cite{wikipedia:designOfRoads}, krawężniki i chodniki oraz wszelkiego rodzaju oznaczenia należące do infrastruktury drogowej (jak np. pasy ruchu, znaki drogowe czy sygnalizacja świetlna).

Czujniki - zainstalowane w samochodzie i zarządzane przez skomplikowane oprogramowanie - stale skanują obszar wokół samochodu. Zbierają dane o wszystkich obiektach obecnych na dystansie do trzech długości boiska piłkarskiego w każdą stronę. Skanowane obiekty to m.in. uczestnicy ruchu drogowego (np. piesi, rowerzyści, inne samochody), sygnalizacja świetlna czy prowizoryczne konstrukcje drogowe stawiane na czas remontów (pachołki, słupki itd.).

Oprócz poprawnej identyfikacji zarejestrowanych obiektów, oprogramowanie samochodu potrafi również przewidywać ich zachowanie w najbliższej przyszłości. Predykcja jest dokonywana na podstawie pomiaru prędkości oraz kierunku ruchu.
Samochód wie, że różne rodzaje obiektów (np. pieszy, motocyklista, ciężarówka) poruszają się w odmienny sposób. Dla każdego z tych rodzajów samochód jest w stanie trafnie określać wiele możliwych trajektorii ruchu obiektów.

Na podstawie zgromadzonych danych, oprogramowanie może określić dokładną trajektorię ruchu, prędkość, linię przejazdu oraz inne informacje niezbędne do dalszego przemieszczania się po drodze w bezpieczny sposób.

Więcej informacji na temat firmy Waymo i rozwijanych przez nią projektów można znaleźć m.in. na ich oficjalnej stronie internetowej: \url{https://waymo.com}.

\subsection{NVIDIA}
Firma NVIDIA od wielu lat angażuje się w prace badawczo-rozwojowe nad szeroko rozumianą tematyką uczenia maszynowego. Jednym ze szczególnych obszarów zainteresowań firmy jest branża automotive.
NVIDIA nie zajmuje się produkcją samochodów autonomicznych, lecz wytwarzaniem kompleksowych systemów sprzętowo-programowych, które mogą stanowić bazę do tworzenia takich pojazdów. \\
NVIDIA współpracuje z wieloma partnerami, którzy kupują od niej te systemy i wykorzystują do rozwoju własnych rozwiązań. Obecnie jest to ponad 370 partnerów \cite{nvidia:partners}. Wśród nich są między innymi: Toyota, Volkswagen, Audi, Volvo.

Strategia biznesowa, oparta na otwarciu się na współpracę z partnerami działającymi w branży transportowej (i nie tylko), przynosi firmie wymierne korzyści finansowe \cite{nvidia:financialSuccess}. 
Duże zainteresowanie współpracą z firmą NVIDIA jest spowodowane faktem, iż oferowany przez nich system otwiera drogę do zupełnie nowych możliwości. Pozwala między innymi na szybkie wdrożenie usługi przewozów miejskich, o czym przekonała się firma Optimus Ride \cite{nvidia:optimusRide}.

Rozwiązania w zakresie samochodów autonomicznych, oferowane przez firmę NVIDIA, występują pod wspólną nazwą NVIDIA DRIVE \cite{nvidia:drive}. Rozwiązania NVIDIA DRIVE można podzielić na część sprzętową (hardware) i programową (software).

\subsubsection{Rozwiązania sprzętowe - NVIDIA DRIVE AGX}
NVIDIA DRIVE AGX to rodzina platform obliczeniowych, zbudowanych na bazie procesora NVIDIA Xavier.
Obecnie w skład tej rodziny wchodzą dwa modele:
\begin{enumerate*}
\item NVIDIA DRIVE AGX Pegasus \\
Osiąga moc obliczeniową 320 TOPS (Tera Operations Per Second), co czyni go najszybszym rozwiązaniem dostępnym obecnie na rynku. Jego architektura oparta jest na dwóch procesorach NVIDIA Xavier i dwóch kartach graficznych TensorCore. \\
Cechuje się wysoką efektywnością energetyczną. Potrafi utrzymywać w wykonaniu wiele sieci neuronowych jednocześnie. Został zaprojektowany do bezpiecznej obsługi wysoce zautomatyzowanych oraz w pełni autonomicznych systemów jazdy. Kierownica i pedały nie są wymagane.
\begin{figure}[h]
\begin{center}
\includegraphics[width=15cm]{resources/figures/nv-drive-pegasus.jpg}
\caption{NVIDIA DRIVE AGX Pegasus}
\label{NvidiaDrivePegasus}
\end{center}
\end{figure}

\item NVIDIA DRIVE AGX Xavier \\
Jest mniejszy od Pegasusa. Dostarcza jedynie 30 TOPS mocy obliczeniowej. Charakteryzuje się jednak bardzo niskim zużyciem energii, pobiera tylko 30 watów. Przeznaczony dla systemów wspomagania kierowcy. Zbyt słaby dla wsparcia w pełni autonomicznych systemów jazdy.
\begin{figure}[h]
\begin{center}
\includegraphics[width=15cm]{resources/figures/nv-drive-xavier.jpg}
\caption{NVIDIA DRIVE AGX Xavier}
\label{NvidiaDriveXavier}
\end{center}
\end{figure}

\item NVIDIA DRIVE Hyperion \\
Najbardziej kompleksowe rozwiązanie oferowane przez firmę NVIDIA. W jego skład wchodzi platforma obliczeniowa (Xavier/Pegasus), zestaw kamer/czujników oraz oprogramowanie sterujące. \\
Więcej informacji o oprogramowaniu znajdzie się w dalszej części rozdziału.
\end{enumerate*}

\subsubsection{Oprogramowanie NVIDIA DRIVE}
W skład pakietu oprogramowania NVIDIA DRIVE wchodzą m.in. następujące komponenty \cite{nvidia:drive:software}:
\begin{enumerate*}
\item DRIVE OS Linux \\
Podstawowy komponent oprogramowania, składający się m.in z wbudowanego systemu czasu rzeczywistego (RTOS), bibliotek NVIDIA CUDA, platformy NVIDIA TensorRT \cite{nvidia:tensorRT} oraz wielu innych modułów. DRIVE OS zapewnia bezpieczne środowisko uruchomieniowe dla aplikacji. Pełni funkcję systemu operacyjnego dla platform obliczeniowych z rodziny NVIDIA DRIVE AGX.
\item DRIVE AV \\
Dostarcza modułów dla percepcji otoczenia (NVIDIA DRIVE Perception \cite{nvidia:drivePerception}), mapowania środowiska (NVIDIA DRIVE Mapping \cite{nvidia:driveMapping}) i planowania trasy (NVIDIA DRIVE Planning \cite{nvidia:drivePlanning})
\item DRIVE IX \\
Dostarcza algorytmów do wizualizacji otoczenia pojazdu, monitoruje zachowanie kierowcy i służy jako asystent kabiny.
\item DriveWorks \\
Jest frameworkiem dostarczającym zestaw bibliotek i narzędzi dla użytkowników pakietu NVIDIA DRIVE.
\end{enumerate*}
\begin{figure}[h]
\begin{center}
\includegraphics[width=15cm]{resources/figures/nvidia-drive-software-stack.jpg}
\caption{Oprogramowanie wchodzące w skład pakietu NVIDIA DRIVE}
\label{NvidiaDriveSoftwareStack}
\end{center}
\end{figure}

\subsection{Udacity}
Udacity jest edukacyjną organizacją oferującą tzw. ,,masywne otwarte kursy online'' (MOOCs - Massive Open Online Courses) \cite{mooc:guide}. Posiadają własną platformę kursową, na której publikowane są kursy dotyczące szeroko pojętej branży IT. \\
Jednym z kursów, oferowanych przez Udacity, jest \textit{Self-Driving Car Engineer Nanodegree program}. Został stworzony w partnerstwie z gigantami branż automotive oraz IT, m.in. Mercedes-Benz, NVIDIA, Uber, BMW.

Wraz z uruchomieniem kursu, firma Udacity zdecydowała się na dosyć odważny krok. Postanowiła zrealizować, we współpracy z programistami z całego świata, własny projekt samochodu autonomicznego. Projekt ten miał być w całości \textbf{otwartoźródłowy}. \\
Jak opisuje Oliver Cameron, ówczesny lider programu Udacity Self-Driving Car \cite{udacity:selfDrivingCar}: \\
,,Gdy decydowaliśmy się na tworzenie programu  \textit{Self-Driving Car Engineer}, od razu wiedzieliśmy, że musimy zbudować własny samochód autonomiczny. (...) utworzyliśmy więc zespół \textit{Self-Driving Car Team}. Jedna z pierwszych decyzji jaką podjęliśmy? \textbf{Kod open source, pisany przez setki studentów z całego świata!}''

Aby wcielić ten projekt w życie, firma Udacity dokonała niezbędnych przygotowań:
\begin{enumerate*}
\item Zakup samochodu marki Lincoln MKZ (rocznik 2016)
\item Montaż dodatkowych komponentów:
\begin{itemize*}
\item Dwa radary LIDAR marki Velodyne VLP-16
\item Jeden radar marki Delphi
\item Trzy kamery marki Point Grey Blackfly
\item Xsens IMU \cite{imu:wikipedia}
\item ECU \cite{ecu:wikipedia}
\item i wiele innych
\end{itemize*}
\item Konfiguracja systemu ROS (Robot Operating System) \cite{ros:about}
\item Stworzenie wstępnej bazy kodu
\end{enumerate*}

Po przygotowaniu platformy pod rozwój projektu, można było rozpocząć prace nad tworzeniem samochodu autonomicznego. Ponieważ naczelnym priorytetem Udacity jest kwestia bezpieczeństwa, postanowiono że problem będzie rozbity na kilka podproblemów, a dla każdego z nich zostanie zorganizowane tzw. ,,wyzwanie Udacity'' (\textit{Udacity Challenge}).

Tak też się stało. Oferowane były atrakcyjne nagrody pieniężne i rzeczowe, a organizatorzy wyzwań mieli okazję na dokładne przetestowanie proponowanych rozwiązań na długo przed zainstalowaniem ich w rzeczywistym samochodzie. Do tej pory zorganizowano kilka takich wyzwań, o szczegółach jednego z nich można przeczytać w \cite{udacity:challenge2}.

\section{Środowiska symulacyjne}
\vspace{0.5cm}
Rozwój samochodów autonomicznych jest bardzo trudnym zadaniem. Jednym z wyzwań stojących przed konstruktorami jest konieczność testowania prototypowanych rozwiązań w samochodzie. Przeprowadzanie takich testów w prawdziwym świecie, na drogach publicznych, jest dla projektów będących na wczesnym etapie rozwoju pomysłem nie tylko bardzo ryzykownym, ale również dość kosztownym. Nawet zakładając, że testy odbywają się w zamkniętym, kontrolowanym środowisku, to i tak jest to proces długi, kosztowny i obarczony wadami.

Aby go ułatwić, a także uczynić tańszym, szybszym i bezpieczniejszym, bardzo popularną techniką jest przeprowadzanie testów w środowisku symulacyjnym. Obecnie istnieje na rynku wiele symulatorów, które są wykorzystywane do powyższych celów. W niniejszej sekcji przedstawię kilka przykładów.

\vspace{1cm}
\subsection{Microsoft AirSim}
Jest symulatorem dla dronów, samochodów i innych pojazdów. Zbudowany na bazie silnika Unreal. Posiada również eksperymentalne wsparcie dla silnika Unity. Jest projektem open source, wspierającym wiele kontrolerów lotu \cite{getfpv:flightControllers}, takich jak na przykład PX4. Projekt jest rozwijany jako wtyczka dla silnika Unreal, którą można łatwo podpiąć do innych projektów zrealizowanych w tym silniku. Jak twierdzą twórcy symulatora \cite{airsim:introducing}: \\
,,\textit{Naszym celem jest aby AirSim służył jako platforma do badań z zakresu AI, uczenia głębokiego, wizji komputerowej oraz algorytmów uczenia ze wzmocnieniem dla pojazdów autonomicznych. AirSim udostępnia multiplatformowe API do pozyskiwania danych i kontrolowania pojazdów.}''

Symulator posiada rozszerzalną architekturę. Można w łatwy sposób dodawać wsparcie dla nowych typów pojazdów czy platform sprzętowych. Pozwala również konfigurować istniejące modele i uzupełniać je o dodatkowe komponenty, takie jak czujniki lub kamery. \\
Więcej informacji na temat symulatora AirSim można znaleźć w następujących źródłach:
\begin{itemize*}
\item Oficjalna strona projektu \cite{airsim:website}
\item Artykuł naukowy pracowników zespołu Microsoft Research \cite{MSR-TR-2017-9}
\item Repozytorium projektu na platformie GitHub \cite{airsim:github}
\end{itemize*}

\newpage
\begin{figure}[H]
\centering
\includegraphics[width=16cm]{resources/figures/airsim_snapshot.png}
\caption{Stopklatka z pracy symulatora AirSim}
\label{AirSimSnapshot}
\end{figure}

\subsection{Voyage Deepdrive}
Darmowy, otwartoźródłowy symulator przeznaczony do rozwoju samochodów autonomicznych. Zapoczątkowany przez Craiga Quitera, programistę od lat zaangażowanego w tworzenie oprogramowania open source.

Jak opisuje Drew Gray, szef działu technologicznego \cite{investopedia:CTO} w firmie Voyage \cite{voyage:introducingDeepdrive}: \\
,,Historia Deepdrive ma swój początek kilka lat temu, gdy Craig - zainspirowany postępem w dziedzinie AI oraz korzyściami jakie społeczeństwo zyska dzięki samochodom autonomicznym - rozpoczął projekt otwartoźródłowej platformy, która daje możliwość rozwoju technologii \textit{self-driving} każdej osobie żyjącej na świecie.''

Gray znał Quitera od dawna. Wiedział o rozwijanym przez niego projekcie i namówił go do współpracy z firmą Voyage. Quiter dołączył do firmy, która to objęła patronat nad dalszym rozwojem symulatora. Niemniej jednak projekt zachował swój pierwotny, otwartoźródłowy charakter.

Deepdrive posiada wiele funkcjonalności, które czynią go atrakcyjnym produktem dla potencjalnych użytkowników. Są to między innymi:
\begin{itemize*}
\item Łatwy dostęp do danych z czujników
\item Trzy zróżnicowane środowiska symulacyjne (mapy)
\item Zaawansowane wbudowane AI - agenci mogą m.in. wyprzedzać inne pojazdy, wyznaczać trasy lub inteligentnie radzić sobie na skrzyżowaniach.
\item Skrypty Python Unreal - całościowe API silnika Unreal \cite{unrealEngine:features} dla języka Python
\end{itemize*}

Symulator Deepdrive kładzie główny nacisk na uczenie kompleksowe (tzw. \textit{end-to-end learning}) oraz głębokie uczenie ze wzmocnieniem (\textit{deep reinforcement learning}). Naukowcy korzystający z symulatora Deepdrive mogą się skupić na rozwiązywanym problemie, a nie na sposobie jego implementacji w symulatorze. Twórcy symulatora mają nadzieję, że dzięki takiemu podejściu praca badawcza nad rozwojem samochodów autonomicznych znacznie przyspieszy.

Rozwój projektu Deepdrive jest ukierunkowany uwagami przekazywanymi przez organizacje, które zajmują się na codzień technologią samochodów autonomicznych. Twórcom symulatora zależy na tym, aby Deepdrive odpowiadał realnym potrzebom twórców takich pojazdów.

Wśród nowości zaproponowanych przez firmę Voyage znajdują się m. in.:
\begin{itemize*}
\item Tablica liderów (\textit{Leaderboard}) - usługa oferowana w ramach symulatora Deepdrive. Zawiera zestawienia rankingowe dla wyzwań ogłoszonych przez zespół Voyage Deepdrive. Pozwala na rywalizację zespołów badawczych, pracujących nad rozwiązaniem danego problemu. Każdy kto zapisze się do usługi, może zgłosić własne rozwiązanie, które następnie zostanie ocenione według kryteriów zdefiniowanych przez organizatorów wyzwania. Więcej informacji znajduje się na oficjalnej stronie usługi \cite{deepdrive:leaderboard}.
\item Szczegółowe mapy świata 3D, zbudowane przy pomocy narzędzia \textit{Parallel Domain} \cite{parallelDomain}. Bogate środowiska symulacyjne zapewniają bardziej realistyczne testy tworzonych modeli.
\item Możliwość generowania nowych scenariuszy testowych przez użytkowników symulatora
\item Zbiór danych treningowych - dane zebrane z ponad 8 godzin jazdy. Łącznie ważą 100 GB. Są to m. in. obrazy z kamer, kąt skrętu kierownicy czy wartości pedałów gazu i hamulca. Dane zostały wstępnie przetworzone, w celu zwiększenia efektywności treningu.
\end{itemize*}

Rysunek \ref{DeepdriveArchitecture} przedstawia schemat reprezentujący architekturę systemu. Na jego podstawie można wysnuć ciekawe wnioski na temat sposobu funkcjonowania symulatora.

\begin{figure}[H]
\centering
\includegraphics[width=16cm]{resources/figures/deepdrive-architecture.png}
\caption{Architektura systemu Deepdrive}
\label{DeepdriveArchitecture}
\end{figure}

Więcej informacji na temat instalacji systemu oraz jego użytkowania można odnaleźć na stronie repozytorium projektu \cite{deepdrive:github}.

\section{Projekty modelarskie}
Projekty modelarskie charakteryzują się tym, iż tworzone są z myślą o modelach pojazdów wykonanych w pewnej skali. Takie projekty cieszą się dość dużą popularnością, a wynika to z kilku faktów. \\
Po pierwsze, modele są o wiele tańsze niż prawdziwe samochody, a oferują zalety niedostępne dla symulatorów. Symulatory, pomimo tego że posiadają potężne możliwości, nie są w stanie dokładnie odwzorować wszystkich zjawisk występujących w rzeczywistym świecie. \\
Po drugie, modele samochodów posiadają zazwyczaj prostą i modularną konstrukcję, co pozwala na stosunkowo szybkie prototypowanie wymyślanych rozwiązań. \\
Po trzecie, czasem łatwiej pracować z modelem niż symulatorem. Dzieje się tak w przypadku, gdy osoba nie posiada komputera o niezbędnej mocy obliczeniowej (symulatory są dość wymagające pod tym kątem), a dysponuje podstawową wiedzą z zakresu elektroniki i budżetem wystarczającym do zakupu niedrogich układów scalonych (typu \textit{Raspberry Pi} lub \textit{Arduino Uno}).

\subsection{donkeycar}
Donkey Car jest otwartoźródłową platformą typu DIY (\textit{Do It Yourself}), przeznaczoną do tworzenia systemów autonomicznych dla samochodów wykonanych w małej skali. Jest bardzo popularna, wielu ludzi korzysta z niej podczas przygotowań do zawodów \textit{DIY Robocars} \cite{diyrobocars:website}. Można zakupić gotowy zestaw (za około 200 dolarów) lub zbudować go samodzielnie.
\begin{figure}[H]
\centering
\includegraphics[width=15cm]{resources/figures/donkeycar_example.png}
\caption{XiaoR GEEK XR-F2 - przykład gotowego do zakupu zestawu \\dla platformy Donkey Car}
\label{DonkeycarExample}
\end{figure}
\newpage
W skład zestawu musi wchodzić:
\begin{enumerate*}
\item Autko RC (pochodzące z listy wspieranych autek \cite{donkeyCar:supportedCars} lub zbudowane według wytycznych \cite{donkeyCar:rollYourOwn})
\item Raspberry Pi \cite{raspberrypi:overview}
\item Kamerka
\item Oprogramowanie wykorzystujące bibliotekę donkeycar.
\end{enumerate*}
Jest to minimalny zestaw, wymagany do poprawnego funkcjonowania platformy. Oczywiście można go rozszerzać o dodatkowe komponenty, takie jak sensory lub inne urządzenia pomiarowe.

Standardowym samochodem, od którego wiele osób rozpoczyna przygodę z platformą Donkey Car, jest \textit{Donkey}.
W oficjalnej dokumentacji projektu \cite{donkeycar:docs} znajdują się wszystkie informacje, niezbędne do samodzielnego zbudowania samochodu.

Sercem platformy jest biblioteka donkeycar, napisana w języku Python. Przeznaczona jest do rozwoju samochodów autonomicznych, jej cechami są modularność i minimalizm. Wykorzystując tę bibliotekę, programowanie samochodu jest bajecznie proste. Oto przykład z oficjalnej dokumentacji, w którym samochód po rozpoczęciu pętli jazdy wykonuje zdjęcia i zapisuje je do wbudowanej pamięci:

\begin{minted}[ fontsize=\fontsize{13}{13} ] {python}
import donkey as dk

#initialize the vehicle
V = dk.Vehicle()

#add a camera part
cam = dk.parts.PiCamera()
V.add(cam, outputs=['image'], threaded=True)

#add tub part to record images
tub = dk.parts.Tub(path='~/mycar/data',
                   inputs=['image'],
                   types=['image_array'])
V.add(tub, inputs=inputs)

#start the vehicle's drive loop
V.start(max_loop_count=100)
\end{minted}

Kod źródłowy biblioteki dostępny jest na stronie repozytorium projektu \cite{donkeyCar:repository}. \\
Ciekawy przykład zastosowania platformy Donkey Car został opisany w artykule \cite{donkey:projectExample}.

\section{Małe prywatne projekty}
Należą do ostatniej z czterech sklasyfikowanych przeze mnie grup. Cechami charakterystycznymi takich projektów są: niski budżet oraz małe zespoły tworzące (często są to pojedyncze osoby). Zazwyczaj tworzone w celach edukacyjnych - twórca chciał się podszkolić z danego zagadnienia.
\subsection{Deep Learning Cars}
Autorem projektu jest austriacki programista Samuel Arzt \cite{artz:deepLearningCars:blog} \cite{artz:deepLearningCars:github}. \\

\begin{figure}[h]
\begin{center}
\includegraphics[width=16cm]{resources/figures/samuelArtzDeepCars.png}
\caption{Stopklatka z pracy systemu}
\label{SamuelArtzDeepLearningCars}
\end{center}
\end{figure}

\subsubsection{Opis implementacji}
Na początku każdej generacji jest tworzonych 20 samochodów (osobników). \\
Każdy samochód posiada własną sieć neuronową oraz zestaw 5 czujników, odmierzających odległość z przodu samochodu.

Sygnały z czujników wysyłane są do neuronów warstwy wejściowej.
Czujniki te służą do wykrywania przeszkód w otoczeniu samochodu.
Każdy czujnik jest skierowany w inną stronę.
Czujniki tworzą "pole widzenia" samochodu o łącznym kącie 90 stopni.

Celem każdego samochodu jest bezkolizyjny przejazd po wyznaczonym torze.
Jedyne operacje jakie może wykonać samochód, to skręt w lewo lub prawo.
Prędkość wszystkich samochodów jest stała i ustalana przed rozpoczęciem generacji.
W chwili kolizji z przeszkodą, samochód umiera.
Należy dodać, iż nie występują kolizje pomiędzy samochodami.

Kiedy wszystkie samochody umrą, bieżąca generacja się kończy.
Osobniki do kolejnej generacji są tworzone przy pomocy algorytmu ewolucyjnego.

Do reprodukcji wybierane są 2 osobniki z najwyższym przystosowaniem.

Przystosowanie jest obliczane na podstawie odległości przebytej przez samochód.
Im większa przejechana odległość, tym wyższa wartość przystosowania samochodu.

Geny dwóch najlepiej przystosowanych osobników są krzyżowane i mutowane, tworząc 20 nowych osobników (potomków).

Genami samochodu są wagi w jego sieci neuronowej.
Zastosowane sieci neuronowe to sieci jednokierunkowe (tzw. feedforward),
z pięcioma neuronami w warstwie wejściowej, dwoma neuronami w warstwie wyjściowej i dwiema warstwami ukrytymi (odpowiednio 4 i 3 neurony).
Uczenie sieci (dostrajanie wartości wag) odbywa się za pomocą algorytmu genetycznego \cite{geneticAlgorithm:introduction}.

\subsubsection{Reprezentacja graficzna}
Dwuwymiarowa symulacja środowiska (toru) została wykonana przy użyciu silnika Unity.
Krzyżyki wyświetlane na ekranie są reprezentacją czujników samochodów.
Kamera podąża za samochodem z najlepszym przystosowaniem.
Dwa samochody z najlepszym przystosowaniem są wyróżniane kolorem.

\subsubsection{Dostępność kodu źródłowego}
Cały kod źródłowy projektu został udostępniony przez autora. \\
Link do repozytorium znajduje się w pozycji literaturowej: \cite{artz:deepLearningCars:github}.
